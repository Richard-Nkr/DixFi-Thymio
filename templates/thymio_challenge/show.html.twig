{% extends 'base.html.twig' %}

{% block title %}Défi Thymio n°{{ thymio_challenge.id }} {% endblock %}

{% block body %}

    {% for message in app.flashes('notification') %}
        <div class="alert alert-info alert-dismissible fade show">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
        </div>
    {% endfor %}

    <fieldset class="showChallenge">

        <div class="buttonMargin">
            <iframe width="420" height="400" src="{{ thymio_challenge.file }}" alt="SolutionDixFi"
                    allowfullscreen></iframe>
        </div>

        <legend>Défi n°{{ thymio_challenge.id }} : {{ thymio_challenge.name }}</legend>

        <p><u>Temps nécessaire</u> : {{ thymio_challenge.duration }} </p>
        <p><u>Difficulté</u> : {{ thymio_challenge.difficulty }} </p>
        <p><u>Description</u> : {{ thymio_challenge.description }} </p>

    </fieldset>


    <div class="buttonMargin">

        {% if is_granted('ROLE_STUDENT_GROUP') %}
            {% if status.statusInt==2 %}

                <div class="form-group">
                    <input type="label" value="Envoyé" placeholder="Envoyé" readonly class="btn btn-success"/>
                </div>
            {% elseif status.statusInt==3 %}
                <div class="form-group">
                    <input type="submit" value="Validé" placeholder="Validé" readonly class="btn btn-success"/>
                </div>
            {% else %}
                <div class="col-sm-4" style="margin:0 auto;">
                    {{ include('thymio_challenge/_add_file_form.html.twig') }}
                </div>
            {% endif %}

        {% elseif is_granted('ROLE_USER_GUEST') %}
            {% if status.statusInt==1 %}
                <form method="post" action="{{ path('validate_user_challenge', {'id':  thymio_challenge.id}) }}"
                      onsubmit="return confirm('Etes-vous certain de vouloir valider ce défi?');">
                    <button class="btnC">Valider</button>
                </form>
            {% else %}
                <button class="btnG"> Défi terminé</button>
            {% endif %}
        {% endif %}



        {% if is_granted('ROLE_TEACHER') %}
            <a href="{{ path('thymio_challenge_solution', {'id': thymio_challenge.id}) }}">
                <button class="btnB2"> Voir la correction</button>
            </a>
        {% endif %}
        <div style="float: right; margin-right: 18%;">
            <a href="{{ path('thymio_challenge_index', {'difficulty': thymio_challenge.difficulty}) }}">
                <button type="button" style="margin-left: 4em;" class="btnB2">Retour aux défis</button>
            </a>
        </div>

    </div>

{% endblock %}
